
\documentclass[12pt]{article}
\usepackage{epsfig,amsfonts,amssymb,amsmath,cite,epic}

%\setlength{\topmargin}{.5cm}
%\setlength{\textheight}{23.1cm}
\setlength{\textwidth}{14.5cm}
%\setlength{\evensidemargin}{2.4cm}
%\setlength{\oddsidemargin}{2.4cm} 
% \renewcommand{\baselinestretch}{1.1}
% 
    \def\CI {{\cal I}}
    \def\CF {{\cal F}}
  
\usepackage{marginnote}
\reversemarginpar
\newcommand{\newnotea}{ \marginnote{\bf New in v3.1:}[-4mm]}
\newcommand{\newnoteb}{ \marginnote{\bf New in v2.1:}[-4mm]}
 

% from Bourjaily arXiv:1212.6974
%\pdfoutput=1
%\let\ifpdf\relax
\usepackage{color}
\let\normalcolor\relax

\newcommand{\mathematica}[3]{\vspace{0.35cm}\noindent\boxed{\begin{minipage}{#1\textwidth}\begin{tabular}{lp{13cm}}{\color{paper_blue}{\scriptsize{\tt In[1]:}}\raisebox{-0.65pt}{{\scriptsize{\tt=}}}}&{\tt #2}\\{\color{paper_blue}{\scriptsize {\tt Out[1]:}}\raisebox{-0.65pt}{{\scriptsize{\tt=}}}}&{\tt #3}\end{tabular}\end{minipage}}\vspace{0.35cm}}

\definecolor{varcolor}{rgb}{0.1,0.55,0.25}
\definecolor{functioncolor}{rgb}{0.1,0.35,0.75}
\definecolor{paper_blue}{rgb}{0.3,0.2,0.75}
\definecolor{paper_red}{rgb}{0.65,0.1,0.15}
\definecolor{paper_green}{rgb}{0.05,0.35,0.125}
\definecolor{paper_grey}{gray}{0.375}
\definecolor{perm}{rgb}{0.1,0.45,0.85}
\definecolor{deemph}{rgb}{0.7,0.7,0.7}
\setlength{\leftmargini}{21pt}
\newcommand{\vardef}[1]{{\color{varcolor}{\sl #1}\rule[-1.05pt]{7.5pt}{.75pt}}}
\newcommand{\vardefms}[1]{{\color{varcolor}{\sl #1}\rule[-1.05pt]{15pt}{.75pt}}}
\newcommand{\vardefo}[1]{{\color{varcolor}{\sl #1}\rule[-1.05pt]{7.5pt}{.75pt}{\bf{\sl :}}}}
\newcommand{\vardefoo}[1]{{\color{varcolor}{\sl #1}\rule[-1.05pt]{15pt}{.75pt}{\bf{\sl :}}}}
\newcommand{\defn}[3]{~\\[-35pt]\begin{itemize}\item[]\indent\hspace{-21pt}$\bullet$\hspace{-.75pt} {\tt {\color{functioncolor}#1}\![}#2{\tt\,]\!:}#3\end{itemize}\vspace{-7pt}
}
\newcommand{\defnNA}[3]{~\\[-30pt]\begin{itemize}\item[]\indent\hspace{-21pt}$\bullet$\hspace{-.75pt} {\tt {\color{functioncolor}#1}\!}#2{\tt\,\!:}#3\end{itemize}\vspace{-10pt}}
\newcommand{\defntb}[4]{~\\[-30pt]\begin{itemize}\item[]\indent\hspace{-21pt}$\bullet$\hspace{-.75pt} {\tt {\color{functioncolor}#1}\![}#2{\tt\,]\![}#3{\tt\,]\!:}#4\end{itemize}\vspace{-10pt}}
\newcommand{\defvar}[2]{~\\[-30pt]\begin{itemize}\item[]\indent\hspace{-21pt}$\bullet$\hspace{-.75pt} \var{#1}: #2\end{itemize}\vspace{-10pt}}
\newcommand{\var}[1]{{\tt{\color{varcolor}{\sl#1}}}}
\newcommand{\ind}{\hspace{4ex}}
\newcommand{\fun}[1]{{\color{functioncolor}#1}}

%%%%%%%%%%%%%%%

\newcommand{\hab}{}



\newcommand{\bZ}{\mathbb{Z}}
\newcommand{\cC}{\mathcal{C}}
\newcommand{\cQ}{\mathcal{Q}}

\newcommand{\IZ}{\mathbb{Z}}
\newcommand{\kk}{k}

\newcommand{\IR}{\mathbb{R}}


\newcommand{\nn}{\nonumber \\}
\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}
\newcommand{\ben}{\begin{eqnarray}\displaystyle}
\newcommand{\een}{\end{eqnarray}}

\newcommand{\refb}[1]{(\ref{#1})}
\newcommand{\p}{\partial}

\newcommand{\ta}{\tilde\alpha}
\newcommand{\cc}{\tilde c}
\newcommand{\ha}{\hat\alpha}
\newcommand{\dx}{c}

\newcommand\bOm{\bar\Omega}
\newcommand\tOm{\widetilde\Omega}


\newcommand{\cN}{\mathcal{N}}
\newcommand{\cM}{\mathcal{M}}
\newcommand{\gref}{g_{\rm Coulomb}}
\newcommand{\gR}{G_{\rm Higgs}}
\newcommand{\gRa}{g_{\rm Higgs}}
\newcommand{\QR}{Q_{\rm Higgs}}
\newcommand{\bQR}{\bar Q_{\rm Higgs}}
\newcommand{\QC}{Q_{\rm Coulomb}}
\newcommand{\bQC}{{\bar Q}_{\rm Coulomb}}
\newcommand{\gC}{G_{\rm Coulomb}}
\newcommand{\OmS}{\Omega^{\rm S}} 
\newcommand{\I}{{\rm i}}
%\newcommand{\eqref}{\refb}

\renewcommand{\theequation}{\thesection.\arabic{equation}}

\newcommand{\href}[1]{#1}

\def\newdefy{\vardef{y}}

\title{CoulombHiggs.m v3.2}
 
\author{Boris Pioline}

\begin{document}

\maketitle

\baselineskip 15pt

%\tableofcontents



The  {\sc Mathematica} package {\tt CoulombHiggs.m} allows to compute the Poincaré-Laurent polynomial of the moduli space of stable representations of quivers using the {\it Coulomb branch} and {\it Higgs branch} formulae. The Higgs branch formula is based on Reineke's solution to the Harder-Narasimhan recursion \cite{MR1974891} and applies to quivers without oriented closed loops. The Coulomb branch is based on a physical picture of BPS states as bound states of elementary 'single-centered' constitutents, and applies to any quivers with or without oriented loops \cite{1011.1258,1103.1887,Manschot:2012rx}.  
The first version of this package was released together with the preprint \cite{Manschot:2013rx} where a general algorithm for computing the index of the quantum mechanics of multi-centered BPS black holes (the Coulomb index) was outlined. The second version 2.0, released along with the preprint \cite{Manschot:2013}, allowed to compute the Dolbeault-Laurent polynomial, relax assumptions on single-centered indices for basis vectors, study the effect of generalized mutations, and more. Version 2.1, released along with the review \cite{Manschot:2014fua}, was optimized to speed up the evaluation of Coulomb indices.  {\bf Starting with version 3.0, the package also implements the Jeffrey-Kirwan residue formula for the refined index of 0+1-dimensional gauged linear models with $\cN=4$ supersymmetry \cite{Hori:2014tda} (see also \cite{Cordova:2014oxa}). 
Starting with version 3.1, it also computes the elliptic genus for 1+1 dimensional gauged
linear sigma models with $(2,2)$ supersymmetry (see \cite{Benini:2013xpa}). }
 The version 3.1 is still in progress. 

The package file {\tt CoulombHiggs.m} and various example files 
can be obtained from the second named author's webpage,
\vskip 2mm

\centerline{\tt http://www.lpthe.jussieu.fr/$\sim$\,pioline/computing.html}

\section{Basic usage}

Assuming that the file {\tt CoulombHiggs.m} is present in the user's {\sc Mathematica} Application 
directory, the package is loaded by entering 

\mathematica{1.0}{ <<CoulombHiggs`}{CoulombHiggs 3.1 - A package for evaluating quiver invariants using the Coulomb branch, Higgs branch and Jeffrey-Kirwan residue formulae. }

If the file  {\tt CoulombHiggs.m} has not yet been copied in the user's {\sc Mathematica} Application 
directory but is in the same directory as the notebook, evaluate instead

\mathematica{1.0}{SetDirectory[NotebookDirectory[]]; <<CoulombHiggs`}{CoulombHiggs v 2.1 - A package for evaluating quiver invariants using the Coulomb and Higgs branch formulae.}


The first main routine  is {\tt \color{functioncolor} CoulombBranchFormula}, whose basic usage is illustrated below: \footnote{Note the following changes in v2.0: the fugacity $y$ 
is no longer a parameter of \fun{CoulombBranchFormula} and \fun{QuiverBranchFormula},
and the former computes the Dolbeault polynomial in terms of $\OmS(\alpha_i,t)$, 
rather than expressing  the Poincar\'e polynomial in terms of $\OmS(\alpha_i)$.
Starting in v2.1, if $\sum_i N_i \zeta_i$  does not vanish, rather than issuing an error message,
a uniform translation is applied internally to the $\zeta_i$'s.  %bp
Other changes are highlighted by margin notes below. }


\mathematica{0.9}{Simplify[CoulombBranchFormula[4\{\{0, 1, -1\},\{-1, 0, 
   1\}, \{1, -1, 0\}\}, \{1/2, 1/6, -2/3\}, \{1, 1, 1\}]]  
     }
   {$ 2+ \frac{1}{y^2}+y^2 +  \text{OmS}(\{1,1,1\},y,t) $
}


%\mathematica{0.9}{Simplify[CoulombBranchFormulaNew[4\{\{0, 1, -1\},\{-1, 0, 
%   1\}, \{1, -1, 0\}\}, \{1/2, 1/6, -2/3\}, \{1, 1, 1\}]]
%%   /.  \{\text{OmS[gam\underline{~}, y\smallwedge n\underline{~}] -> OmS[gam, t\smallwedge
%%   n]},  \text{OmS[gam\underline{~}, y] -> OmS[gam, t]}\}
%  }
%   {$ 2+ \frac{1}{y^2}+y^2 +  \text{OmS}(\{1,1,1\}, t) $
%}

This routine computes the Dolbeault-Laurent polynomial  of the quiver moduli space, expressed in terms of the single-centered indices. 
The first argument corresponds to the matrix of DSZ products $\alpha_{ij}$ (an antisymmetric matrix of integers), the second to the FI parameters $\zeta_i$ (a vector of rational numbers), the third to the dimension vector $N_i$ (a vector of integers). 
The variables
 $y$ and $t$ are fugacities conjugate to the sum of the Dolbeault
degrees $p+q$ (i.e. the angular
momentum) and to the difference of the Dolbeault
degrees $p-q$, respectively. The Poincar\'e-Laurent
polynomial is obtained by setting $t=1$. For generic superpotential, the single-centered
indices $\OmS(\gamma,y)\equiv \OmS(\gamma,y,1)$ are conjectured to be
independent of $y$.  In the above example,  the 
Dolbeault polynomial of the moduli space of a three-node Abelian cyclic quiver with $4$ arrows between each subsequent node is expressed in terms of the single-centered index
$\OmS(\gamma_1+\gamma_2+\gamma_3,y,t)$. 

The second main routine is {\tt \color{functioncolor} HiggsBranchFormula}, which computes the
Poincar\'e-Laurent polynomial  using the Higgs branch formula  (which is only valid for quivers without oriented  loop, but the routine works irrespective of this
assumption). The arguments are the same as for {\tt \color{functioncolor} CoulombBranchFormula}: 

\mathematica{1.0}{Simplify[HiggsBranchFormula[\{\{0, 3\},\{-3, 0\}\}, \{1/2,-1/2\}, \{2, 2\}]]
  }
   {$ -\frac{\left(y^2+1\right) \left(y^8+y^4+1\right)}{y^5} $
}

The above command computes the Poincar\'e-Laurent polynomial for the Kronecker quiver with 3 arrows, FI parameters $(1/2,-1/2)$, dimension vector $(2,2)$. 

Finally, the routine {\tt \color{functioncolor} JKIndex} implements the Jeffrey-Kirwan residue formula. 
Its first argument is an extended charge matrix, where the rows encode the charges of the chiral
multiplets under $U(1)^{\sum N_i}$, along with the R-charge and the multiplicity. The second argument
is the dimension vector $N_i$, and the last argument is the stability condition $\eta$, a vector of length $\sum N_i$. 
The charge matrix can be obtained from the DSZ matrix,R-matrix and dimension vector using {\tt \color{functioncolor} ChargeMatrixFromQuiver}. For example,  the index of a two-node quiver with three arrows, dimension vector $N_i=(1,2)$, stability vector 
$\eta=(1,-2/5,-3/5)$ is obtained from 


\mathematica{1.0}{
FrozenCartan = \{\{1, 1\}\}; 
JKIndex[ ChargeMatrixFromQuiver[\{\{0, 3\}, \{-3, 0\}\}, \{\{0, 0\}, \{0, 0\}\}, \{1, 
   2\}], \{1, 2\}, \{1, -2/5,-3/5\}]
}{$y^2+1+\frac{1}{y^2} $}   

The variable $\var{FrozenCartan}$ is a list of pairs $(i,s)$, which specifies that the list of Cartan variables $u_{i,s}$ (associated to the $i$-th gauge group $U(N_i)$, with $s=1\dots N_i)$ should be frozen to 0, rather than integrated over. For quiver quantum mechanics the overall $U(1)$ factor in $\prod_i U(N_i)$ decouples one variable, e.g. $u_{1,1}$, must be frozen to 0.

A variant {\tt \color{functioncolor} JKIndexSplit} of the same routine is provided, which computes the same index by first splitting the vector multiplet determinant as a sum over (equivalence classes of) permutations, using Cauchy's determinant formula, and computes the Jeffrey-Kirwan residue of each term separately (the two procedures are of course identical for Abelian quivers). This simplifies both the enumeration of stable flags (as the number of singular hyperplanes due to vector multiplets is reduced from $N_i(N_i-1)$ to $\mathcal{O}(N_i)$) and the computation of the residues. Moreover, for quivers with loops this splitting appears to match the sum over decompositions $\gamma=\sum\alpha_i$ in the Coulomb branch formula \cite{Pioline2015}. The list of all splittings, along with their multiplicity, is stored in the global variable ${\tt \color{varcolor} ListAllPerms}$.

For the evaluation of the residue, we note that it is more efficient to use a rational representation of the integrand (using exponentiated Cartan variables) than a trigonometric representation. Both options are allowed in the code, mainly for debugging.



The package allows for much
more, as documented below. 
Inline documentation can be 
obtained by typing e.g. 

\mathematica{1.0}{?CoulombBranchFormula}
   {}

\section{Symbols}

 
\defvar{y}{fugacity conjugate to the sum of Dolbeault degrees $p+q$ (i.e. angular momentum);}


\defvar{t}{fugacity conjugate to the difference of Dolbeault degrees $p-q$;}

\defvar{q}{modular parameter in the elliptic genus, $q=e^{2\pi i \tau}$;}

\defvar{tau}{complex modulus in the elliptic genus;}


\defn{Om}{\vardef{charge vector},\newdefy}{denotes the refined index  
$\Omega(\gamma,y)$;}

\defn{Omb}{\vardef{charge vector},\newdefy }{denotes the rational refined index
$\bar\Omega(\gamma,y)$;}


\defn{OmS}{\vardef{charge vector},\newdefy,\vardef{t} }{denotes the single-centered index 
$\OmS(\gamma,y,t)$. } 

\defn{OmS}{\vardef{charge vector},\newdefy}{denotes 
$\OmS(\gamma,y)\equiv \OmS(\gamma,y,t=1)$.}

\defn{OmS}{\vardef{charge vector}}{denotes 
$\OmS(\gamma,y)$, under the assumption that it is independent of $y$ (which is
conjectured to be the case for  generic superpotential)}


\defn{OmT}{\vardef{charge vector},\newdefy }{denotes the (unevaluated)  
function $\Omega_{\rm tot}(\gamma,y)$;}

\defn{Coulombg}{\vardef{list of charge vectors},\newdefy }{: denotes the (unevaluated) Coulomb index $\gref(\{\alpha_i\},\{c_i\},y)$, leaving the FI parameters unspecified;} 

\defn{HiggsG}{\vardef{charge vector},\newdefy }{denotes the (unevaluated)  
stack invariant $\gR(\gamma,y)$;}



\defn{CoulombH}{\vardef{list of charge vectors},\vardef{multiplicity vector},\newdefy }{denotes the (unevaluated) factor $H(\{\alpha_i\},\{n_i\},y)$ appearing in the formula  for 
$\Omega_{\rm tot}(\sum n_i\alpha_i,y)$  in terms of 
$\OmS(\alpha_i,y)$.}

\defn{QFact}{\vardef{n},\newdefy }{represents the (non-evaluated) $q$-deformed factorial $[n,y]!$}

\newnotea \defvar{z}{chemical potential, $y=e^{i\pi z}$;}

\defvar{tau}{elliptic modulus, $q=e^{2\I\pi\tau}$;}

\defvar{u[i,s]}{$s$-th Cartan variable for the $i$-th gauge group when the trigonometric representation is used,
exponentiated version $e^{2\pi i u_{i,s}}$ of the same when a rational representation is used.}

\defvar{ut[i,s]}{Cartan variables in rotated basis adapted to a singularity, so that the flag is $\tilde u_{1,1}=\dots = u_{K,N_K}=0$ in trigonometric representation, or $\tilde u_{1,1}=\dots = u_{K,N_K}=1$ in rational representation.}

\defvar{FrozenCartan}{List of pairs $\{i,s\}$ which specifies the list of Cartan variables $u_{i,s}$ which should be frozen to 0 (or 1 in rational representation), rather than integrated over. }

\defvar{ListuAll}{Flat list of all Cartan variables $u[i,s]$, $i=1\dots K$, $s=1,\dots N_i$}

\defvar{FrozenMask}{Vector of booleans indicating non-frozen entries in \var{ListuAll}}

\defvar{Listu}{Flat list of unfrozen Cartan variables $u[i,s]$}

\defvar{Listut}{Flat list of unfrozen rotated Cartan variables $ut[i,s]$}

\defvar{FrozenRuleEuler}{Rule for replacing the frozen $u[i,s]$ by 0}

\defvar{FrozenRuleRat}{Rule for replacing the frozen $u[i,s]$ by 1}

\defvar{Theta[\vardef{z}]}{Jacobi Theta series $\theta_1(z,\tau)=-\I q^{1/8} (e^{\I \pi z}-e^{-\I \pi z)}) 
\prod_{k\geq 1} (1-q^k) (1-e^{2\pi \I z} q^k)(1-e^{-2\pi \I z} q^k) $}

\defvar{Eta}{Dedekind Eta series $\eta(\tau)=q^{1/24} \prod_{k\geq 1} (1-q^k)$}



\section{Environment variables}


\defvar{{\tt \$QuiverPerturb1}}{Sets the size of the perturbation $\epsilon_1=1/\var{\$QuiverPerturb}$ of the DSZ products, set to 1000 by default.}

\defvar{{\tt \$QuiverPerturb2}}{Sets the size of the perturbation $\epsilon_2=1/\var{\$DSZPerturb}$ of the DSZ products, set to $10^{10}$ by default.}


\defvar{{\tt \$QuiverNoLoop}}{If set to True, the quiver will be assumed to have no oriented loop, hence all $H$ factors and all $\OmS(\alpha)$ will be set to zero (unless $\alpha$ is a basis vector). Set to False by default.}

\defvar{{\tt \$QuiverTestLoop}}{If set to True, all $H$ factors and $\OmS(\alpha)$ corresponding to subquivers without loops will be set to zero (unless $\alpha$ is a basis vector).
Set to True by default.
Determining whether a subquiver has loops is time-consuming, so for large quivers it may be advisable to disable this feature. Note that 
\var{{\tt \$QuiverNoLoop}} takes precedence over this variable.}

\defvar{{\tt \$QuiverMultiplier}}{Overall scaling factor of the DSZ matrix in any evaluation of 
\var{\tt Coulombg} or \var{\tt HiggsG}. Set to 1 by default, could be a formal variable.}

\defvar{{\tt \$QuiverVerbose}}{If set to False, all consistency tests on data and corresponding error messages will be skipped. Set to True by default.}

\defvar{{\tt \$QuiverDisplayCoulombH}}{If set to True, the routine 
\fun{\tt CoulombBranchFormula} will return a list   $\{ \var{Q}, \var{R} \}$ where
 $\var{Q}$  is the Poincar\'e-Laurent   polynomial and \var{R} is a  list of replacement rules for the \var{CoulombH} factors. Set to False by default.}

\defvar{{\tt \$QuiverPrecision}}{Sets the numerical precision with which all consistency tests
are carried out. This is set to 0 by default since all data are assumed to be rational numbers. This can be set to a small real number when using real data, however the user is warned that rounding errors
tend to grow quickly.}



\defvar{{\tt \$QuiverRecursion}}{If set to 1 (default value), then the new recursion relations 
from \cite[v2]{Manschot:2013rx} are used for computing
\fun{\tt CoulombF};  if set to 0  the recursion relation
from \cite[v1]{Manschot:2013rx}  is used instead. } 

\defvar{{\tt \$QuiverOmSbasis}}{Set to 1 by default. If set to 0,  the routines 
\fun{\tt SimplifyOmSbasis} and \fun{\tt SimplifyOmSbasismult} are deactivated, so that 
 the assumption that basis 
vectors carry $\OmS(\ell\gamma_i)=\delta_{\ell,1}$ is relaxed.}  

\defvar{{\tt \$QuiverOpt}}{Set to 1 by default. If set to 0,  the routines
\fun{\tt CoulombF}, \fun{\tt CoulombG}, \fun{\tt CoulombIndex} will use the non-optimized
code provided in version 2.0, otherwise they use the optimized code provided in version 2.1.}  %bp

\defvar{kmax}{Maximal power in the $q$-expansion of the elliptic genus. Set to 0 by default.}


%\end{itemize}



\section{Coulomb index}

\defn{CoulombF}{\vardef{Mat},\vardef{Cvec}}{returns the index of collinear solutions 
$F(\{\ta_1,\cdots \ta_n\}, \{\cc_1,\cdots \cc_n\})$ with 
                   DSZ products $\ta_{ij}=\var{Mat}[[i,j]]$, FI terms $\cc_i=\var{Cvec}[[i]]$ 
                   and trivial ordering.}

\defn{CoulombG}{\vardef{Mat}}{returns the index of scaling collinear solutions 
$G(\{\ha_1,\cdots \ha_n\})$ 
with  DSZ products $\ha_{ij}=\var{Mat}[[i,j]]$ and trivial ordering. The total angular momentum 
                   $\sum_{i<j} Mat[[i,j]]$ must vanish;}

\defn{CoulombIndex}{\vardef{Mat},\vardef{PMat},\vardef{Cvec},\newdefy }{evaluates the Coulomb index $\gref(\{\alpha_1,\cdots $ $\alpha_n\};$ $\{\dx_1,\cdots \dx_n\};y)$ 
                   with DSZ products $\alpha_{ij}=\var{Mat}[[i,j]]$, perturbed to \var{PMat}[[i,j]] so as to lift 
                   accidental degeneracies, possibly rescaled by an overall factor of 
                   \var{{\tt \$QuiverMultiplier}}, 
                   FI terms $\dx_i=\var{Cvec}[[i]]$, angular momentum fugacity \var{y};
                   }


\defn{CoulombFNum}{\vardef{Mat}}{computes numerically the index $F(\{\ta_1,\dots \ta_n\},\{\cc_1,\dots \cc_n\})$  with DSZ matrix $\ta_{ij}=\var{Mat}[[i,j]]$ and FI parameters $\cc_i=\var{Cvec}[[i]]$. For testing purposes only, works for up to 5 centers.}

\defn{CoulombGNum}{\vardef{Mat}}{computes numerically the scaling index $G(\ha_1,\dots \ha_n)$  with DSZ matrix $\ha_{ij}=\var{Mat}[[i,j]]$. For testing purposes only, works for up to 6 centers.}
                   

\defn{CoulombIndexNum}{\vardef{Mat},\vardef{PMat},\vardef{Cvec},\vardef{k},\newdefy }{returns the Coulomb index $\gref(\{\alpha_1,\cdots $ $\alpha_n\};$ $\{\dx_1,\cdots \dx_n\};y)$ 
                   with DSZ products $\alpha_{ij}=\var{Mat}[[i,j]]$,  possibly rescaled by an overall factor of 
                   \var{{\tt \$QuiverMultiplier}},  
                   FI terms $\dx_i=\var{Cvec}[[i]]$, angular momentum fugacity \var{y}, by searching
                   collinear solutions numerically;    For testing purposes only, works for up to 5 centers.               }


\defn{EvalCoulombIndex}{\vardef{Mat},\vardef{PMat},\vardef{Cvec},\vardef{f} }{evaluates
any $\var{Coulombg[Li,y]}$ appearing in $\var{f}$ as $\var{CoulombIndex[\var{Mat2},\var{PMat2},\var{Cvec2},y]}$, where $\var{Mat2},\var{PMat2},\var{Cvec2}$ are computed from the list of vectors $\var{Li}$ and the quiver data $\var{Mat},\var{PMat},\var{Cvec}$. }


\section{Coulomb branch formula}

 \defn{CoulombBranchFormula}{\vardef{Mat},\vardef{Cvec},\vardef{Nvec}}
	                                   {computes  the Dolbeault %Poincar\'e-Laurent
                   polynomial  of a quiver with DSZ products $\alpha_{ij}=\var{Mat}[[i,j]]$,
                   dimension vector $N_i=\var{Nvec}[[i]]$, 
                   FI parameters $\zeta_i=\var{Cvec}[[i]]$,
                   in terms of single-centered invariants $\OmS$.
                  This standalone routine first constructs the Poincar\'e-Laurent 
                  polynomial,
                   evaluates the Coulomb indices $\gref$, 
                   determines the $H$ factors recursively using the minimal modification hypothesis
                   and finally replaces $y$ by $t$ in the argument of $\OmS$ to construct
                   the Dolbeault polynomial. 
If \var{{\tt \$QuiverDisplayCoulombH}} is 
                   set to True, the routine  returns a list $\{ \var{Q}, \var{R} \}$,
                                    where $\var{Q}$ is the Poincar\'e polynomial and \var{R} is a  list of replacement rules for the \var{CoulombH} factors.
                                                       For quivers without loops, the process can be sped up greatly by setting \var{\tt \$QuiverNoLoop} to True.
                   For complicated quivers
                   it is advisable to implement the Coulomb branch formula step by step, using the 
                   more elementary routines described below. 
                   }


                   
 \defn{CoulombBranchFormulaFromH}{\vardef{Mat},\vardef{Cvec},\vardef{Nvec},\vardef{R} }
	                                   {returns the Dolbeault
                   polynomial  of a quiver with DSZ products $\alpha_{ij}=\var{Mat}[[i,j]]$,  
                   dimension vector $N_i=\var{Nvec}[[i]]$, 
FI parameters $\zeta_i=\var{Cvec}[[i]]$, using the rule 
           \var{R} to replace all \var{CoulombH} factors.}
                   


\defn{QuiverPoincarePolynomial}{\vardef{Nvec},\newdefy }{constructs the Poincar\'e-Laurent
                   polynomial of a quiver. Coincides with
                   \fun{\tt QuiverPoincarePolynomialRat}                   for primitive dimension vector;
                 }


\defn{QuiverPoincarePolynomialRat}{\vardef{Nvec},\newdefy }{constructs the rational Poincar\'e-Laurent
                   polynomial $\bQC(\gamma;\zeta;y)$;}
         
\defn{QuiverPoincarePolynomialExpand}{\vardef{Mat},\vardef{PMat},\vardef{Cvec},
\vardef{Nvec}, \vardef{Q}}{
                  evaluates the Cou-lomb 
                  indices $\gref$ and   total 
                   single-centered indices $\Omega_{\rm tot}(\alpha_i,y)$   appearing in the 
                  Poincar\'e-Laurent polynomial \var{Q} of a quiver with DSZ products
                  $\alpha_{ij}=\var{Mat}[[i,j]]$, perturbed to 
                   $\var{PMat}[[i,j]]$, 
                   dimension vector $N_i=\var{Nvec}[[i]]$, 
                 FI parameters $\zeta_i=\var{Cvec}[[i]]$;}


  

\defn{CoulombHSubQuivers}{\vardef{Mat},\vardef{PMat},\vardef{Nvec},\newdefy }{computes recursively all \var{CoulombH} factors for DSZ matrix \var{Mat}, perturbed to \var{PMat},
and any dimension vector strictly less than \var{Nvec}; relies on the next two routines:}

                  
                   \defn{ListCoulombH}{\vardef{Nvec},\vardef{Q}}{ returns
                   returns
                   a pair $\{\var{ListH},\var{ListC}\}$ where \var{ListH} is a list of \var{CoulombH}
                    factors possibly
                   appearing in the Poincar\'e-Laurent polynomial \var{Q }of a quiver with dimension vector 
                   \var{Nvec}, and \var{ListC} is the list of coefficients which multiply the monomials in 
                   $\OmS(\alpha_i,y)$ canonically associated to the $H$ factors in \var{Q}.}

         
\defn{SolveCoulombH}{\vardef{ListH},\vardef{ListC},
\vardef{R}}{ returns
                   a list of replacement rules for the \var{CoulombH} factors 
                   listed in \var{ListH}, by applying the minimal modification hypothesis
                   to the coefficients listed in \var{ListC}. The last argument  is 
                   a replacement rule for \var{CoulombH} factors associated to subquivers.}
                   

\defn{MinimalModif}{\vardef{f}}{returns the symmetric Laurent polynomial which coincides 
                   with the Laurent expansion expansion of the symmetric rational function $f$ at $y=0$, up to strictly positive powers of $y$. Here symmetric means invariant under $y\to 1/y$. In practice,
\fun{\tt  MinimalModif}[\var{f}] evaluates the contour integral in \cite{Manschot:2012rx}, Eq 2.9
\be
\label{uint}
\oint \frac{{\rm d} u}{2\pi {\rm i}} \frac{(1/u-u) \, f(u)}{(1-u y)(1-u/y)}
\ee 
by deforming the contour around 0 into a sum of counters over all poles of $f(u)$ and zeros
of $(1-uy)(1-u/y)$. This trick allows to compute \eqref{uint} even if the order of the pole of $f(y)$
at $y=0$ is unknown, which happens if  \var{{\tt \$QuiverMultiplier}} is a formal variable.
                   }

\defn{SimplifyOmSbasis}{\vardef{f}}{replaces  $\OmS(\gamma,y)\to 1$ when $\gamma$ is a basis vector, unless  \var{{\tt \$QuiverOmSbasis}} is set to 0; 
}  

\defn{SimplifyOmSbasismult}{\vardef{f}}{replaces  $\OmS(\gamma,y)\to 0$ when $\gamma$   is a non-trivial multiple of a basis vector, unless  \var{{\tt \$QuiverOmSbasis}} is set to 0;} 



\defn{CoulombHNoLoopToZero}{\vardef{Mat},\vardef{f}}{sets to zero any $H$
                  factor in \var{f} corresponding to subquivers without loop, assuming DSZ products
                  $\alpha_{ij}=\var{Mat}[[i,j]]$
                  ; active only on 2-node subquivers if \var{{\tt \$QuiverTestLoop}} is set to False}


\defn{OmTNoLoopToZero}{\vardef{Mat},\vardef{f}}{sets to zero any $\Omega_{\rm tot}$
                  factor in \var{f} corresponding to subquivers without loop, assuming DSZ products
                  $\alpha_{ij}=\var{Mat}[[i,j]]$
                  ; active only on 2-node subquivers if \var{{\tt \$QuiverTestLoop}} is set to False
                  }

\defn{OmSNoLoopToZero}{\vardef{Mat},\vardef{f}}{sets to zero any $\OmS$  
                  factor in \var{f} corresponding to subquivers without loop, assuming DSZ products
                  $\alpha_{ij}=\var{Mat}[[i,j]]$
                  ; active only on 2-node subquivers if \var{{\tt \$QuiverTestLoop}} is set to False
                  }

                   \defn{EvalCoulombH3}{\vardef{Mat},\vardef{f}}{ evaluates any 3-center $H$ factor with multiplicity vector $\{1,1,1\}$ 
               appearing   in $f$. Not used in any routine so far.}

\defn{DropFugacity}{\vardef{f}}{replaces $\OmS(\gamma,y^m,t^m)$ by $\OmS(\gamma,t^m)$ everywhere in $f$}  
                
\defn{SwapFugacity}{\vardef{f}}{replaces $\OmS(\gamma,y^m)$ with $\OmS(\gamma,y^m,t^m)$ everywhere in $f$} 


\section{Higgs branch formula}

\defn{HiggsBranchFormula}{\vardef{Mat},\vardef{Cvec},\vardef{Nvec} }
	                                   {standalone routine which computes the Poincar\'e-Laurent
                   polynomial  of a quiver with DSZ products $\alpha_{ij}=\var{Mat}[[i,j]]$ (possibly              rescaled by \var{{\tt \$QuiverMultiplier}}), dimension vector $N_i=\var{Nvec}[[i]]$, 
                   FI parameters $\zeta_i=\var{Cvec}[[i]]$, using Reineke's formula. 
                   It is assumed, but not checked, that the quiver has no oriented 
                   loop;}


\defn{StackInvariant}{\vardef{Mat},\vardef{Cvec},\vardef{Nvec},\newdefy }{gives 
                 the stack 
                  invariant 
                  of a quiver with DSZ matrix $\alpha_{ij}=\var{Mat}[[i,j]]$, possibly rescaled 
                  by an overall factor of 
                   \var{{\tt \$QuiverMultiplier}}, 
                  FI parameters $\zeta_i=\var{Cvec}[[i]]$,  dimension vector $N_i=\var{Nvec}[[i]]$, 		using Reineke's formula; the answer is written in terms of unevaluated
		$q$-deformed factorials \var{QFact[n,y]};}
		
		\defn{AbelianStackInvariant}{\vardef{Mat},\vardef{Cvec},\newdefy }{gives 
                 the Abelian stack 
                  invariant 
                  of a quiver with DSZ matrix $\alpha_{ij}=\var{Mat}[[i,j]]$, possibly rescaled 
                  by an overall factor of 
                   \var{{\tt \$QuiverMultiplier}}, 
                  FI parameters $\zeta_i=\var{Cvec}[[i]]$, 		
                  using Reineke's formula; coincides with \fun{\tt StackInvariant} 
                  with \var{Nvec}$=\{1,\dots 1\}$ except that tests of marginal or threshold stability
                  are performed (unless   \var{\tt \$QuiverVerbose} is set to False);
                  }
                   


\section{Utilities}

\defn{ListAllPartitions}{\vardef{charge vector}}{returns the list of unordered 
                   partitions $\{\alpha_i\}$ of the positive integer vector $\gamma$ as a sum of positive, non-zero integer vectors $\alpha_i$; 
                   }
                   
                   \defn{ListAllPartitionsMult}{\vardef{charge vector}}{returns the list of unordered 
                   partitions $\{\alpha_i,m_i\}$ of the positive integer vector $\gamma$ as a sum of positive, non-zero integer vectors $\alpha_i$ with multiplicity $m_i$; 
                   }

\defn{ListSubQuivers}{\vardef{Nvec}}{gives a list of all dimension vectors less or equal to \var{Nvec};}


\defn{SubDSZ}{\vardef{Mat},\vardef{Cvec},\vardef{Li}}{gives the
                    DSZ matrix of the subquiver made of the charge vectors in list \var{Li};}

 \defn{SymmetryFactor}{\vardef{Li}}{gives the symmetry factor $1/  |{\rm Aut}(\{\alpha_1, \alpha_2,\cdots, \alpha_n\}|$ for the list of charge vectors \var{Li};}

\defn{OmTRat}{\vardef{Nvec},\newdefy }{ gives the rational total invariant 
$\bar\Omega_{\rm tot}(\gamma;y)$ in terms of $\Omega_{\rm tot}(\gamma;y)$.
Coincides with the latter if $\gamma$ is primitive.}

\defn{OmTToOmS}{\vardef{f}}{expands out any $\Omega_{\rm tot}(\gamma;y)$ in $f$
 into $H$ factors and $\OmS$'s;}
           
\defn{OmToOmb}{\vardef{f}}{expresses any $\Omega(\gamma;y)$ in $f$
 in terms of $\bar\Omega(\gamma;y)$'s;}

\defn{OmbToOm}{\vardef{f}}{expresses  any $\bar\Omega(\gamma;y)$ in $f$
 in terms of $\Omega(\gamma;y)$'s;}

                 
\defn{HiggsGToOmb}{\vardef{Nvec},\newdefy }{Returns the (unevaluated) HN invariant
$\gR(\gamma,y)$ in terms of the rational refined indices $\bar\Omega(\gamma;y)$;}

\defn{OmbToHiggsG}{\vardef{Nvec},\newdefy }{Returns the (unevaluated) rational refined index $\bar\Omega(\gamma;y)$ in terms of the (unevaluated) 
stack invariants $\gR(\gamma,y)$;}



\defn{RandomCvec}{\vardef{Nvec}}{generates a random set of FI parameters $\zeta_i$ between -1 and 1, such that $\sum \zeta_i\, \var{Nvec}[[i]]=0$;}

\defn{UnitStepWarn}{\vardef{x}}{gives 1 for $x>0$, 0 for $x<0$, and $1/2$ if $x=0$. Produces a warning in this latter case, irrespective of the value of \var{\tt \$QuiverVerbose}. If so, the user
is advised run the 
computation again with a different random perturbation. For efficiency, this instruction is no longer
used in v2.1, however a warning is still issued if one encounters a Heaviside function 
with zero argument in the evaluation of the Coulomb indices. %bp
}

\defn{GrassmannianPoincare}{\vardef{k},\vardef{n},\newdefy}{computes the Poincar\'e
polynomial of the Grassmannian $G(k,n)$ via Eq. (6.22) in \cite{Manschot:2012rx}.} 

\defn{CyclicQuiverOmS}{\vardef{avec},\vardef{t}}{computes the single-centered index 
$\OmS(\gamma_1,\dots, \gamma_K)$ associated
to a cyclic Abelian quivers with DSZ matrix $\alpha_{i,j+1}=\var{avec}[[i,i+1]]$ via Eq
(4.29) in \cite{Manschot:2012rx}.} 

\defn{QuiverPlot}{\vardef{Mat}}{Displays the quiver with DSZ matrix \var{Mat}.} 

\defn{FIFromZ}{\vardef{Nvec},\vardef{Zvec}}{Computes the FI parameters $\{c_i\}$ from the vector of central charges $\var{Zvec}=\{Z_i\}$ and dimension vector $\var{Nvec}=\{N_i\}$ via $c_i = \Im(e^{-i\phi} Z_i)$, where $\phi$ is the argument of $\sum_i N_i Z_i$. The parameters $c_i$ are rounded up to the nearest rational number with denominator less than \var{\tt \$QuiverPerturb1}.}

\defn{AttractorFI}{\vardef{Mat}}{gives the list of net number of arrows at each node. Perhaps an analogue of the attractor point for quivers.}

\defn{QDeformedFactorial}{\vardef{n},\newdefy }{gives the $q$-deformed factorial $[n,y]!$}

\defn{EvalQFact}{\vardef{f}}{evaluates any \var{QFact[n,y]} appearing in \var{f}}

\defn{ExpandTheta}{\vardef{f}}{Replaces $\var{Theta}$ and $\var{Eta}$ by their $q$-expansions, truncated at order $\var{kmax}$}

\defn{qSeries}{\vardef{f}}{Replaces $\tau$ by $\log q/(2\pi i)$, and Taylor expand around $q=0$ up to order $\var{kmax}$}

\defn{SubVectors}{\vardef{Nvec}}{List all positive dimension vectors which are strictly less than $\var{Nvec}$.}

\defn{EulerForm}{\vardef{Mat}}{construct the antisymmetric Ringel-Tits form from the intersection matrix $\var{Mat}$ (coincides with the latter if $\var{Mat}$ is antisymmetric).}

\defn{ListLoopRCharges}{\vardef{Mat},\vardef{RMat}}{Lists the oriented closed loops and corresponding R-charge.}

\defn{TestNoLoop}{\vardef{Mat},\vardef{Li}}{Tests if the subquiver associated to the  charge vectors $\var{Li}$ has oriented closed loops.}

\subsection{Mutations}  

The following routines and environment variables were introduced in  {\tt CoulombHiggs.m} v1.1,
to allow investigation of mutations of generalized quivers \cite{Manschot:2013}:

\defn{MutateRight}{\vardef{Mat},\vardef{Cvec},\vardef{Nvec},\vardef{k}}{
Computes the  DSZ matrix, FI parameters and dimension vector of the quiver obtained
by applying a right-mutation with respect to the node $k$. If \var{k} is a list $\{k_i\}$,  then the
right mutations $k_i$ are applied successively, starting from the last entry in \var{k}.  No
consistency check on the FI parameters is performed.}

\defn{MutateLeft}{\vardef{Mat},\vardef{Cvec},\vardef{Nvec},\vardef{k}}{
Computes the  DSZ matrix, FI parameters and dimension vector of the quiver obtained
by applying a left-mutation with respect to the node $k$. If \var{k} is a list $\{k_i\}$,  then the
right mutations $k_i$ are applied successively, starting from the last entry in \var{k}. No
consistency check on the FI parameters is performed.} 

\defn{OmStoOmS2}{\vardef{f}}{replaces $\var{\tt OmS[gam,y,t]}$ by $\var{\tt OmS2[gam,y,t]}$
anywhere in $\var{f}$. This is useful for distinguishing the single-centered invariants of the mutated
quiver from those of the original one.}

\defn{MutateRightOmS}{\vardef{Mat},\vardef{k},\vardef{f}}{expresses the single-centered
invariants $\var{\tt OmS[gam,y,t]}$ of the original quiver with DSZ matrix \var{Mat} in terms of the single-centered
invariants $\var{\tt OmS2[gam,y,t]}$ of the quiver obtained by right-mutation with respect to node $k$,
using Eq. 1.13 in \cite{Manschot:2013}.}

\defn{MutateLeftOmS}{\vardef{Mat},\vardef{k},\vardef{f}}{expresses the single-centered
invariants $\var{\tt OmS[gam,y,t]}$ of the original quiver with DSZ matrix \var{Mat} in terms of the single-centered
invariants $\var{\tt OmS2[gam,y,t]}$ of the quiver obtained by left-mutation with respect to node $k$,
using Eq. 1.13 in \cite{Manschot:2013}.}

\defn{MutateRightOmS2}{\vardef{Mat},\vardef{k},\vardef{f}}{expresses the single-centered
invariants $\var{\tt OmS2[gam,y,t]}$ a quiver with DSZ matrix \var{Mat} in terms of the single-centered
invariants $\var{\tt OmS[gam,y,t]}$ of the quiver obtained by right-mutation with respect to node $k$.
Identical to \fun{\tt MutateRightOmS}, except for swapping $\var{\tt OmS[gam,y,t]}$ and $\var{\tt OmS2[gam,y,t]}$.}

\defn{MutateLefttOmS2}{\vardef{Mat},\vardef{k},\vardef{f}}{expresses the single-centered
invariants $\var{\tt OmS2[gam,y,t]}$ a quiver with DSZ matrix \var{Mat} in terms of the single-centered
invariants $\var{\tt OmS[gam,y,t]}$ of the quiver obtained by right-mutation with respect to node $k$.
Identical to \fun{\tt MutateLeftOmS}, except for swapping $\var{\tt OmS[gam,y,t]}$ and $\var{\tt OmS2[gam,y,t]}$.}

\defn{DropOmSNeg}{\vardef{f}}{equates to 0 any $\OmS(\gamma,y,t)$ where the dimension
vector associated to $\gamma$ has negative components.}

\defvar{{\tt \$QuiverMutationMult}}{Equal to 1 by default. Set to $M$, defined in Eq. (1.8) of
  \cite{Manschot:2013} when dealing with generalized quivers.}  

\section{Jeffrey-Kirwan residue formula}

\newnotea

\defn{ChargeMatrixFromQuiver}{\vardef{Mat},\vardef{RMat},\vardef{Nvec}}{constructs the charge matrix for a quiver with DSZ matrix \var{Mat}, R-charge matrix \var{RMat}, and dimension vector \var{Nvec}; the last two columns are the R-charge and multiplicity. Do not forget to set $\var{FrozenCartan}=\{\{1,1\}\}$ to decouple the overall $U(1)$. For non-quiver gauge theories, \var{ChargeMatrix} must be provided by hand.}

\defn{JKIndex}{\vardef{ChargeMatrix},\vardef{Nvec},\vardef{Etavec}}{standalone routine, which computes the $\chi_y$ genus of the GLSM with given charge matrix, dimension vector and stability parameter.}


\defn{InitializeJK}{\vardef{Nvec},\vardef{FrozenCartan}}{initializes the internal variables \var{FrozenMask}, \var{FrozenRuleEuler}, \var{FrozenRuleRat}, \var{Listu}, \var{Listut}}

\defn{gEuler}{\vardef{ChargeMatrix},\vardef{Nvec}}{computes the integrand in the residue formula for the Euler number}
 
\defn{gRat}{\vardef{ChargeMatrix},\vardef{Nvec}}{constructs the integrand in the residue formula for the $\chi_y$ genus in rational representation}

\defn{gTrig}{\vardef{ChargeMatrix},\vardef{Nvec}}{constructs the integrand in the residue formula for the $\chi_y$ genus in trigonometric representation}

\defn{gElliptic}{\vardef{ChargeMatrix},\vardef{Nvec}}{constructs the integrand in the residue formula for the elliptic genus}


\defn{JKResidueRat}{\vardef{Flags},\vardef{f}}{extracts the sum of the residues of \var{f} (in rational representation) at the specified Flags, weighted with sign; the first entry in \var{Flags} is the intersection point, the second is a list of r-plets of charges for each flag}

\defn{JKResidueTrig}{\vardef{Flags},\vardef{f}}{extracts the sum of the residues of \var{f} (in trigonometric representation) at the specified Flags, weighted with sign; the first entry in \var{Flags} is the intersection point, the second is a list of r-plets of charges for each flag}

\defn{JKIndexEulerFromStableFlags}{\vardef{ChargeMatrix},\vardef{Nvec},\vardef{ListStableFlags}}{computes the Euler index from the specified list of all stable flags}

\defn{JKIndexRefinedFromStableFlags}{\vardef{ChargeMatrix},\vardef{Nvec},\vardef{ListStableFlags}}{computes the $\chi_y$ genus (in rational representation) from the specified list of all stable flags}

\defn{JKIndexTrigFromStableFlags}{\vardef{ChargeMatrix},\vardef{Nvec},\vardef{ListStableFlags}}{computes the $\chi_y$ genus (in trigonometric representation) from the specified list of all stable flags}

\defn{JKIndexEllipticFromStableFlags}{\vardef{ChargeMatrix},\vardef{Nvec},\vardef{ListStableFlags}}{computes the elliptic genus from the specified list of all stable flags}


\defn{FindSingularities}{\vardef{ChargeMatrix}}{constructs the list of singular hyperplanes for the specified charge matrix}

\defn{FindStableFlags}{\vardef{ListSings},\vardef{Nvec},\vardef{Etavec}}{constructs the list of stable flags with stability parameter \var{Etavec}$\in\IR^{\sum N_i}$ from the specified list of singular hyperplanes}



\subsection{Improved scheme using Cauchy's formula}

\defn{JKIndexSplit}{\vardef{ChargeMatrix},\vardef{Nvec},\vardef{Etavec}}{standalone routine, which computes the $\chi_y$ genus of the GLSM with given charge matrix, dimension vector and stability parameter, using Cauchy's formula to split the vector multiplet determinant \cite{Pioline2015}.}


\defn{gEulerPartial}{\vardef{ChargeMatrix},\vardef{Nvec},\vardef{ListPerm}}{constructs the partial contribution to the integrand in the residue formula for the index, corresponding to the list of partitions \var{Listperm}}

\defn{gTrigPartial}{\vardef{ChargeMatrix},\vardef{Nvec},\vardef{ListPerm}}{constructs the partial contribution to the integrand in the residue formula for the $\chi_y$ genus in trigonometric representation, corresponding to the list of partitions \var{Listperm}}

\defn{gRatPartial}{\vardef{ChargeMatrix},\vardef{Nvec},\vardef{ListPerm}}{constructs the partial contribution to the integrand in the residue formula for the $\chi_y$ genus in rational representation, corresponding to the list of partitions \var{Listperm}}

\defn{gEllipticPartial}{\vardef{ChargeMatrix},\vardef{Nvec},\vardef{ListPerm}}{constructs the partial contribution to the integrand in the residue formula for the elliptic genus in rational representation, corresponding to the list of partitions \var{Listperm}}

\defn{JKIndexEulerSplitFromStableFlags}{\vardef{ChargeMatrix},\vardef{Nvec},\vardef{ListStableFlags}}{computes the Euler index from the specified list of all stable flags}

\defn{JKIndexRefinedSplitFromStableFlags}{\vardef{ChargeMatrix},\vardef{Nvec},\vardef{ListStableFlags}}{computes the $\chi_y$ genus (in rational representation) from the specified list of all partial stable flags}

\defn{JKIndexTrigSplitFromStableFlags}{\vardef{ChargeMatrix},\vardef{Nvec},\vardef{ListStableFlags}}{computes the $\chi_y$ genus (in trigonometric representation) from the specified list of all partial stable flags}

\defn{JKIndexEllipticSplitFromStableFlags}{\vardef{ChargeMatrix},\vardef{Nvec},\vardef{ListStableFlags}}{computes the elliptic genus  from the specified list of all partial stable flags}


\defn{PartialChargeMatrix}{\vardef{ChargeMatrix},\vardef{Nvec},\vardef{perm}}{constructs the extended charge matrix consisting of chiral multiplets and vector multiplet contributions associated to the permutations perm}

\subsection{Internal routines}

\defn{TestStableFlag}{\vardef{Listhyper},\vardef{Flag},\vardef{Etavec}}{Tests if 
\var{Flag} is stable for the list of hyperplanes \var{Listhyper} and stability  parameter \var{Etavec}.}

\defn{CompleteChargeMatrix}{\vardef{ChargeMatrix},\vardef{Nvec},\vardef{perm}}{constructs the extended charge matrix consisting of chiral multiplets and vector multiplets}


\defn{SameFlagQ}{\vardef{Q1},\vardef{Q2}}{tests if the flags \var{$Q_1$} and \var{$Q_2$} (represented by square charge matrices) are equivalent}

\defn{LegCharge}{\vardef{Nvec},\vardef{i1},\vardef{s1},\vardef{i2},\vardef{s2}}{constructs a charge vector with 1 in position $(i_1,s_1)$ and $-1$ in position $(i_2,s_2)$}

\defn{TrimChargeTable}{\vardef{ChargeMatrix}}{removes the last two columns and frozen entries in charge matrix}

\defn{FindIntersection}{\vardef{Sing}}{computes the intersection points of the hyperplanes listed in \var{Sing}; this may include points on the cylinder, which contribute to the $\chi_y$ genus but not to the Euler number ! Ultimately, this will be generalized for the computation of the elliptic genus to include all points on the torus.  }

\defn{FlagToHyperplanes}{\vardef{Flag}}{translates the flag \var{Flag}, given as r-plet of charge vectors, into a list of linear combinations of Cartan variables $u_{i,s}$}


\defn{ListHyperplanesIntersectingAt}{\vardef{ListSings},\vardef{Inter}}{collects all the hyperplanes in \var{ListSings} which intersect at \var{Inter}}

\defn{TestProjectiveIntersection}{\vardef{ListSings},\vardef{Inter}}{tests if the intersection point \var{Inter} of the list of hyperplanes \var{ListSings} is projective}

\defn{CollectHyperplanes}{\vardef{ListInterrplets},\vardef{Inter}}{collects all the hyperplanes from \var{ListInterrplets}, which intersect at the point \var{Inter}}

\defn{TestStableFlag}{\vardef{ListHyper},\vardef{Flag},\vardef{Etavec}}{tests if the flag \var{Flag} constructed out of the hyperplanes in \var{ListHyper} is stable with respect to \var{Etavec}}

\defn{PartitionToPermutation}{\vardef{pa}}{translates the partition pa into a standard permutation}

\defn{PermutationToPartition}{\vardef{perm}}{translates the standard permutation perm into a partition}

\defn{PartitionMultiplicity}{\vardef{pa}}{computes the multiplicity of a partition in Cauchy's formula}

\defn{ListPermutationsWithMultiplicity}{\vardef{Nvec}}{computes the list of all multi-partitions of \var{Nvec}, represented by a standard permutation, and their multiplicity}


\begin{verbatim}



\end{verbatim}


\begin{thebibliography}{9}

\bibitem{MR1974891}
M.~Reineke, ``The {H}arder-{N}arasimhan system in quantum groups and cohomology
  of quiver moduli,'' {\em Invent. Math.} {\bf 152} (2003), no.~2, 349--368.

\bibitem{1011.1258} 
  J.~Manschot, B.~Pioline and A.~Sen,
  ``Wall Crossing from Boltzmann Black Hole Halos,''
  JHEP {\bf 1107}, 059 (2011)
  [arXiv:1011.1258 [hep-th]].
  %%CITATION = ARXIV:1011.1258;%%

\bibitem{1103.1887} 
  J.~Manschot, B.~Pioline and A.~Sen,
  ``A Fixed point formula for the index of multi-centered N=2 black holes,''
  JHEP {\bf 1105}, 057 (2011)
  [arXiv:1103.1887 [hep-th]].
  %%CITATION = ARXIV:1103.1887;%%

%\cite{Manschot:2012rx}
\bibitem{Manschot:2012rx}
  J.~Manschot, B.~Pioline and A.~Sen,
  ``From Black Holes to Quivers,''
  JHEP {\bf 1211} (2012) 023
  [arXiv:1207.2230 [hep-th]].
  %%CITATION = ARXIV:1207.2230;%%

\bibitem{Manschot:2013rx}
  J.~Manschot, B.~Pioline and A.~Sen,
  ``On the Coulomb and Higgs branch formulae for multi-centered black holes and quiver invariants,''
  JHEP {\bf 1305} (2013) 166
  [arXiv:1302.5498 [hep-th]].
  %%CITATION = ARXIV:1302.5498;%%
  %3 citations counted in INSPIRE as of 26 Sep 2013
  
\bibitem{Manschot:2013}
  J.~Manschot, B.~Pioline and A.~Sen,
  ``Generalized quiver mutations and single-centered indices,''
  JHEP {\bf 1401} (2014) 050
  [arXiv:1309.7053 [hep-th]].
  %%CITATION = ARXIV:1309.7053;%%
  %3 citations counted in INSPIRE as of 26 Apr 2014

    
%\cite{Manschot:2014fua}
\bibitem{Manschot:2014fua}
  J.~Manschot, B.~Pioline and A.~Sen,
  ``The Coulomb Branch Formula for Quiver Moduli Spaces,''
  arXiv:1404.7154 [hep-th].
  %%CITATION = ARXIV:1404.7154;%%
  %6 citations counted in INSPIRE as of 21 sept. 2015

%\cite{Hori:2014tda}
\bibitem{Hori:2014tda}
  K.~Hori, H.~Kim and P.~Yi,
  ``Witten Index and Wall Crossing,''
  JHEP {\bf 1501} (2015) 124
  [arXiv:1407.2567 [hep-th]].
  %%CITATION = ARXIV:1407.2567;%%
  %19 citations counted in INSPIRE as of 21 sept. 2015
  
  %\cite{Benini:2013xpa}
\bibitem{Benini:2013xpa}
  F.~Benini, R.~Eager, K.~Hori and Y.~Tachikawa,
  ``Elliptic Genera of 2d ${\mathcal{N}}$ = 2 Gauge Theories,''
  Commun.\ Math.\ Phys.\  {\bf 333} (2015) 3,  1241
  [arXiv:1308.4896 [hep-th]].
  %%CITATION = ARXIV:1308.4896;%%
  %59 citations counted in INSPIRE as of 21 sept. 2015

 %\cite{Cordova:2014oxa}
\bibitem{Cordova:2014oxa}
  C.~Cordova and S.~H.~Shao,
  ``An Index Formula for Supersymmetric Quantum Mechanics,''
  arXiv:1406.7853 [hep-th].
  %%CITATION = ARXIV:1406.7853;%%
  %16 citations counted in INSPIRE as of 21 sept. 2015
     
\bibitem{Pioline2015}
B. Pioline et al, "From the Hirzebruch index to the Coulomb branch formula", in progress.    

\end{thebibliography}

\end{document}